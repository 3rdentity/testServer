<!DOCTYPE html>

<html lang='en'>

  <head>

    <meta charset='utf-8'>
    <meta name='author' content='cactose + shasharala'>
    <meta name='description' content=''>
    <link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,700,700italic'>
    <link rel='icon' type='image/x-icon' href='http://grappl.io:888/html/grapplicon.ico'>
    <link rel='stylesheet' type='text/css' href='res/vendor/normalize.min.css'>
    <link rel='stylesheet' type='text/css' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css'>
    <link rel='stylesheet' type='text/css' href='res/css/main.css'>
    <title>Grappl - You are the cloud now</title>

  </head>

  <body>

    <!-- Modals
    ===========================================================================
    Placed at the beginning of the document to avoid being affected by other
    components -->
    <div id='modalDonate' class='modal fade'>
      <div class='modal-dialog'>
        <div class='modal-content'>
          <div class='modal-header'>
            <button type='button' class='close' data-dismiss='modal'>&times;</button>
            <h4 class='modal-title'>Donate</h4>
          </div>
          <div class='modal-body'>
            You can donate any amount you want, any help is appreciated!
            If you donate $5 or more and include your username
            you will be able to alpha test new features, like static ports, which
            let you keep the same address every time you start Grappl.
            (Alpha tester status has to be applied manually, so it will take a small amount of time to show up.)

            <!-- PayPal Form -->
            <form action='//www.paypal.com/cgi-bin/webscr' method='post' target='_top'>
              <input type='hidden' name='cmd' value='_donations'>
              <input type='hidden' name='business' value='8U9DK42DS2US2'>
              <input type='hidden' name='lc' value='US'>
              <input type='hidden' name='item_name' value='Grappl'>
              <input type='hidden' name='button_subtype' value='services'>
              <input type='hidden' name='currency_code' value='USD'>
              <input type='hidden' name='bn' value='PP-BuyNowBF:btn_buynow_LG.gif:NonHosted'>
              <table>
                <tr>
                  <td>
                    <input type='hidden' name='on0' value='Username'>
                  </td>
                </tr>
                <tr>
                  <td>
                    <input id='inputDonate' type='text' name='os0' placeholder='Username' maxlength='100'>
                  </td>
                </tr>
              </table>
              <input type='image' src='//www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif' border='0' name='submit' alt='PayPal - The safer, easier way to pay online!'>
              <img alt='' border='0' src='//www.paypalobjects.com/en_US/i/scr/pixel.gif' width='1' height='1'>
            </form>

          </div>
        </div>
      </div>
    </div>

    <div id='modalRegister' class='modal fade'>
      <div class='modal-dialog'>
        <div class='modal-content'>
          <div class='modal-header'>
            <button type='button' class='close' data-dismiss='modal'>&times;</button>
            <h4 class='modal-title'>Register</h4>
          </div>
          <div class='modal-body'>
            <form>
              <input type='text' name='user' placeholder='Username' maxlength='100'>
              <span class='sr-only'>Username</span>
              <br>
              <input type='password' name='pass' placeholder='Password' maxlength='100'>
              <span class='sr-only'>Password</span>
              <br>
              <input type='password' name='pass2' placeholder='Confirm password' maxlength='100'>
              <span class='sr-only'>Confirm password</span>
              <br>
            </form>
          </div>
          <div class='modal-footer'>
            <p class='err'></p>
            <button class='btn btn-success' id='submitRegister'>Submit</button>
          </div>
        </div>
      </div>
    </div>

    <div id='modalLogin' class='modal fade'>
      <div class='modal-dialog'>
        <div class='modal-content'>
          <div class='modal-header'>
            <button type='button' class='close' data-dismiss='modal'>&times;</button>
            <h4 class='modal-title'>Login</h4>
          </div>
          <div class='modal-body'>
            <form>
              <input type='text' name='user' placeholder='Username' maxlength='100'>
              <span class='sr-only'>Username</span>
              <br>
              <input type='password' name='pass' placeholder='Password' maxlength='100'>
              <span class='sr-only'>Password</span>
              <br>
            </form>
          </div>
          <div class='modal-footer'>
            <p class='err'></p>
            <button class='btn btn-success' id='submitLogin'>Submit</button>
          </div>
        </div>
      </div>
    </div>

    <div id='modalLicense' class='modal fade'>
      <div class='modal-dialog'>
        <div class='modal-content'>
          <div class='modal-header'>
            <button type='button' class='close' data-dismiss='modal'>&times;</button>
            <h3 class='modal-title'>License</h3>
          </div>
          <div class='modal-body'>
            <p>Do not use Grappl to transmit any copyrighted material that you do not have the right to transmit.
            <br/>
            Do not use Grappl to do anything illegal.</p>
            <p>You are responsible for what you use this service for.</p>
            <p>There is no uptime guarantee.</p>
            <hr/>
            <h4>Licensed Software</h4>
            <ul>
              <li><a href='https://github.com/twbs/bootstrap/blob/master/LICENSE' target='_blank'>Bootstrap</a></li>
              <li><a href='https://jquery.org/license/' target='_blank'>jQuery</a></li>
              <li><a href='/res/vendor/normalize/LICENSE.md' target='_blank'>Normalize</a></li>
              <li><a href='/res/vendor/Open_Sans/LICENSE.txt' target='_blank'>/res/vendor/Open_Sans/LICENSE.txt</a></li>
            </ul>
          </div>
          <div class='modal-footer'>
            Website design by <a href='//www.shasharala.net' rel='author'>shasharala</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Header
    ======================================================================= -->
    <nav class='navbar'>
        <div class='navbar-header'>
          <button type='button' class='navbar-toggle' data-toggle='collapse' data-target='#theNavbar'>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
          </button>
          <a class='navbar-brand' href='/' rel='prefetch'>
            <img id='logo' src='http://grappl.io:888/html/logo.png' alt='grappl logo' />
            <span id='logoTxt'>You are the cloud now</span>
          </a>
        </div>
        <div class='collapse navbar-collapse' id='theNavbar'>
          <ul class='nav navbar-nav navbar-right'>
            <li><a href='/' rel='prefetch'><span class='glyphicon glyphicon-home'></span> Home</a></li>
            <li><a id='btnDonate'><span class='glyphicon glyphicon-heart'></span> Donate</a></li>
            <li class='dropdown'>
              <a class='dropdown-toggle' data-toggle='dropdown'>
                <span class='glyphicon glyphicon-download-alt'></span> Download
                <span class='caret'></span>
              </a>
              <ul class='dropdown-menu'>
                <li><a href='//grappl.io:888/html/GrapplLauncher.exe'>Windows</a></li>
                <li><a href='//grappl.io:888/html/GrapplLauncher.jar'>Linux &amp; OSX</a></li>
              </ul>
            </li>
            <li class='dropdown'>
              <a class='dropdown-toggle' data-toggle='dropdown'>
                <span class='glyphicon glyphicon-user'></span> Account
                <span class='caret'></span>
              </a>
              <ul class='dropdown-menu'>
                <li><a id='btnRegister'>Register</a></li>
                <li><a id='btnLogin'>Login</a></li>
              </ul>
            </li>
            <li class='dropdown'>
              <a class='dropdown-toggle' data-toggle='dropdown'>
                <span class='glyphicon glyphicon-alert'></span> Help
                <span class='caret'></span>
              </a>
              <ul class='dropdown-menu'>
                <li><a href='/status' rel='prefetch'>Server Status</a></li>
                <li><a href='/faq' rel='prefetch'>FAQ</a></li>
                <li><a href='//github.com/Cactose/Grappl' rel='prefetch'>Source Code</a></li>
              </ul>
            </li>
          </ul>
        </div>
    </nav>



    <!-- Content
    ======================================================================= -->
    <div style='background-color: hsla(200, 66%, 49%, 0.55)' class='container'>
      <div class='row'>

        <main class='col-lg-12'>
            <p>
              Grappl is a tool that lets you host virtually any type of server anywhere, with no port forwarding!
              <br/>
              Better yet, it's completely free software, and the client is licensed LGPL v.2.1.
            </p>
            <p>
              How to Run
              <br/>
              Start it.
              <br/>
              Either log in or choose to be anonymous.
              <br/>
              Enter your server's local port number.
              <br/>
              The public address will appear in the grappl window.
            </p>
        </main>
      </div>

      <div class='row'>
        <!-- Image Carousel
        =================================================================== -->
        <section id='imgCarousel' class='col-lg-8 carousel slide' data-ride='carousel'>

          <!-- Indicators -->
          <ol class='carousel-indicators'>
            <li data-target='#imgCarousel' data-slide-to='0' class='active'></li>
            <li data-target='#imgCarousel' data-slide-to='1'></li>
            <li data-target='#imgCarousel' data-slide-to='2'></li>
            <li data-target='#imgCarousel' data-slide-to='3'></li>
          </ol>

          <!-- Wrapper for slides -->
          <div class='carousel-inner' role='listbox'>
            <div class='item active'>
              <img src='res/img/normalGUI.png' alt='Normal GUI' width='70%'>
            </div>

            <div class='item'>
              <img src='res/img/console.png' alt='Console' width='100%'>
            </div>

            <div class='item'>
              <img src='res/img/advancedGUI.png' alt='Advanced GUI' width='100%'>
            </div>

            <div class='item'>
              <img src='res/img/httpDebug.png' alt='HTTP Debug' width='100%'>
            </div>
          </div>

          <!-- Left and right controls -->
          <a class='left carousel-control' href='#imgCarousel' role='button' data-slide='prev'>
            <span class='glyphicon glyphicon-chevron-left' aria-hidden='true'></span>
            <span class='sr-only'>Previous</span>
          </a>
          <a class='right carousel-control' href='#imgCarousel' role='button' data-slide='next'>
            <span class='glyphicon glyphicon-chevron-right' aria-hidden='true'></span>
            <span class='sr-only'>Next</span>
          </a>
        </section>

        <!-- Twitter Widget
        =================================================================== -->
        <section class='col-lg-4'>
          <a class='twitter-timeline' href='https://twitter.com/Cactose' data-widget-id='616471055713083392' target='_blank'>Tweets by @Cactose</a>
            <script>
              ! function(d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0],
                  p = /^http:/.test(d.location) ? 'http' : 'https';
                if (!d.getElementById(id)) {
                  js = d.createElement(s);
                  js.id = id;
                  js.src = p + '://platform.twitter.com/widgets.js';
                  fjs.parentNode.insertBefore(js, fjs);
                }
              }(document, 'script', 'twitter-wjs');
            </script>
        </section>

      </div>
    </div>



    <!-- Footer
    ======================================================================= -->
    <footer>
      <div class='container'>
        <a id='license' rel='license'>License</a>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <a href='mailto:matt@daexsys.com'>Contact: matt@daexsys.com</a>
      </div>
    </footer>



    <!-- JavaScript
    ===========================================================================
    Placed at the end of the document so the page loads faster -->
    <!-- jQuery CDN Fallback-->
    <script src='https://code.jquery.com/jquery-2.1.4.min.js'></script>
    <script>window.jQuery || document.write('<script src="/res/vendor/jquery-2.1.4.min.js"><\/script>')</script>

    <!-- BootstrapJS CDN Fallback -->
    <script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js'></script>
    <script>window.jQuery.fn.modal || document.write('<script src="/res/vendor/bootstrap-3.3.5-dist/js/bootstrap.min.js"><\/script>')</script>
    <script>
        (function($) {
            $(function onLoad() {
              // BootstrapCSS CDN Fallback
                if ($('html').css('font-family') !== 'sans-serif') {
                    $('head').append('<link rel="stylesheet" href="/res/vendor/bootstrap-3.3.5-dist/css/bootstrap.min.css">');
                }
            });
            // Event Listeners
            $('#btnDonate').click(function clickDonate() {
              $('#modalDonate').modal('show');
            });
            $('#modalDonate').on('shown.bs.modal', function modalDonateFocus() {
              $('#inputDonate').first()
                .focus();
            })
            $('#btnRegister').click(function clickRegister() {
              $('#modalRegister').modal('show');
            });
            $('#modalRegister').on('shown.bs.modal', function modalRegisterFocus() {
              $('#modalRegister input').first()
                .focus();
            })
            $('#btnLogin').click(function clickLogin() {
              $('#modalLogin').modal('show');
            });
            $('#modalLogin').on('shown.bs.modal', function modalLoginFocus() {
              $('#modalLogin input').first()
                .focus();
            })
            $('#license').click(function clickLicense() {
              $('#modalLicense').modal('show');
            });
            $('#submitRegister').click(function submitRegister() {
               $.ajax({
                  type: 'POST',
                  url: '/registerhandler',
                  data: $('#modalRegister form').serialize(),
                  success: function(msg) {
                    $('#modalRegister p').html(msg)
                      .fadeIn()
                      .delay(3000)
                      .fadeOut();
                  },
                  error: function submitRegisterError() {
                    $('#modalRegister p').html('Connection error. Please try again or <a href="mailto:matt@daexsys.com">contact us</a>.')
                      .fadeIn()
                      .delay(3000)
                      .fadeOut();
                  }
                });
            });
            $('#submitLogin').click(function submitLogin() {
               $.ajax({
                  type: 'POST',
                  url: '/auth',
                  data: $('#modalLogin form').serialize(),
                  success: function(msg) {
                    /*
                    It is standard for the backend to not inform the user what information exactly they have provided is wrong
                    In regard to this custom keep responses to a minimum and do not seperate information about username or password
                    */
                    switch (msg) {
                      /*
                      This case could be one word and a custom message could be set to $('modalLogin p').html in response
                      Example:
                      case 'error':
                        $('#modalLogin p').html('Incorrect username or password.')
                          .fadeIn()
                          .delay(3000)
                          .fadeOut()
                        break;
                      */
                      case 'Incorrect username or password.':
                        $('#modalLogin p').html(msg)
                          .fadeIn()
                          .delay(3000)
                          .fadeOut();
                        break;
                      default:
                        /*
                        A login response will contain three parameters in a string:
                        'msg;cookie;redirecton'
                        'Welcome, testificatealice;1442846245957;/account'
                        */
                        var arr = msg.split(';');
                        msg = arr[0]; // Set msg to actual message from response
                        var c = arr[1] // Set c to cookie provided in response
                        var r = arr[2] // Set r to redirecton page provided in response
                        $('#modalLogin p').html(msg)
                          .fadeIn()
                          .delay(1000, function CBLogin() {
                            document.cookie = c; // Set user cookie
                            window.location.href = r; // Redirect user
                          });
                    }
                  },
                  error: function submitLoginError() {
                    $('#modalLogin p').html('Connection error. Please try again or <a href="mailto:matt@daexsys.com">contact us</a>.')
                      .fadeIn()
                      .delay(3000)
                      .fadeOut();
                  }
                });
            });
        })(window.jQuery);
    </script>

  </body>

</html>
